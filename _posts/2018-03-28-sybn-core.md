---
layout: post
title:  "sybn-core 项目介绍"
categories: about
tags:  about sybn-util
author: sybn
---

* content
{:toc}


基础工具是 sybn-core 和 sybn-core-java8 项目，其包括如下主要功能：
- 常用的通用JavaBean sybn-core cn.sybn.bean 包
  - 缓存对象 cache 包
  - 计数器对象 counter 包
  - 实体对象 entry 包
  - 异常对象 exception 包
  - 主函数对象 main 包
  - 返回值对象 result 包
  - 范围对象 scope 包
  - 时间范围对象 times 包
- 独立工具集 sybn-core cn.sybn.singleutil 包

  此包下所有工具没有额外依赖，可以拎出来独立运行。
  默认只依赖如下开源库： self4j,junit,apache-commons-lang3
  部分测试业务依赖了其他包，但是可以随时删除。
  
- 复杂工具集 sybn-core cn.sybn.util 包
  - 字符串工具 string 包
  - 单对象数据转换 
  - 对象集合数据转换
  - 对象集合 group 成 Map
  - 对象集合 group by 统计 及 fill 补零
  - 任务及日志工具 task包
  - 数据库业务通用包 id.db 包
  - 定义了 SybnQuery 和 CrudQueryCommonDao 接口
- 测试工具集 sybn-core cn.sybn.test 包

## 导入项目
```xml
<!-- 基础包 -->
<dependency>
  <groupId>net.kokozu.sybn</groupId>
  <artifactId>sybn-core</artifactId>
  <version>0.1.8-SNAPSHOT</version>
</dependency>

<!-- java8 增强包 -->
<dependency>
  <groupId>net.kokozu.sybn</groupId>
  <artifactId>sybn-core-java8</artifactId>
  <version>0.1.8-SNAPSHOT</version>
</dependency>
```

## AbsMain - 主函数封装
- 常规写法:

```java
// 一个jar包只能有一个主函数
public static void main(String[] args) throws InterruptedException {

  // 执行任务
  runWork();

}
```

- 使用工具后的写法

```java
/**
* 根据指定配置文件跑数据 java -jar yq_etl_news.jar --main=yq_etl_news --profiles=./init_idc.properties
*/
public static void main(String[] args) throws InterruptedException {
  SybnMain main = new SybnMainEngine();
  // 注册一个job，一个jar可以注册很多主函数
  main.register(
    "yq_etl_news_source", // 被注册的函数名
    "说明:将42媒体的原始数据(baseData表)初步清洗为格式化数据(formatData表)", // 被注册的函数说明
    new TaskResultCallable() { // 被注册的函数
      @Override
      public ResultBase exec() throws Exception {
        return run();  // 执行函数
      }
    }
  );
  main.runMain(args);
}
```

- 效果说明

  AbsMain 执行了如下操作:
  
  - 验证命令行参数是不是指定了 --main=yq_etl_news 如果是则执行exec1; 否则报错;
  - 如果jar中有多个可选任务,也可以在这里路由到exe2或者exe3, 具体情况参考 AbsMain 的注释,也可以看看demo类 AbsMainDemo
  - 初始化 init_idc.properties, 这个配置文件可以在jar包内部或者外部(参考代码注释)
  - 使用 ReadConfUtil.getValue() 可以读取到 命令行参数或者 init_idc.properties 文件中的值.
  - 如果希望从数据库读取配置信息,需要使用 SqlServerSettingUtil 但 AbsMain 中没有涉及这个类,后期另行说明.
